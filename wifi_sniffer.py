from scapy.all import sniff, HTTPRequest

# Function to process captured packets
def process_packet(packet):
    if packet.haslayer(HTTPRequest):
        url = packet[HTTPRequest].Host.decode() + packet[HTTPRequest].Path.decode()
        method = packet[HTTPRequest].Method.decode()
        src_ip = packet[IP].src
        dst_ip = packet[IP].dst

        print(f"Source IP: {src_ip} -> Destination IP: {dst_ip}")
        print(f"Method: {method} -> URL: {url}")
        print("\n")

# Start sniffing Wi-Fi traffic
print("Sniffing Wi-Fi network activity...")
sniff(filter="tcp port 80 or tcp port 443", prn=process_packet, store=0)
